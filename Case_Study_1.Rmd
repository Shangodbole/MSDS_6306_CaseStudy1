---
title: "Case Study 1"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(magrittr)
library(ggplot2)
library(knitr)
library(kableExtra)
library(dplyr)
library(qwraps2)


```

##### Get the Data

```{r}

file = "/Users/shantanu/Data_Files/Breweries.csv"
Breweries = read.csv(file=file,head=TRUE,sep=",")


file = "/Users/shantanu/Data_Files/Beers.csv"
Beers = read.csv(file=file,head=TRUE,sep=",")


file = "/Users/shantanu/Data_Files/statesize.csv"
State.Size = read.csv(file=file,head=TRUE,sep=",")
names(State.Size)[3] = "State"

```


##### 1. How many breweries are present in each state?

```{r}

Breweries.state <- as.data.frame(table(Breweries$State))

names(Breweries.state) = c("State", "Num of Breweries")

Breweries.state$State <- invisible(trimws(Breweries.state[,1]))

Breweries.state$State <- factor(Breweries.state$State)

Breweries.state <- merge(x = Breweries.state, y = State.Size, by = "State",all.x = TRUE)

Breweries.state.display <- data.frame(Breweries.state$State,  Breweries.state$`Num of Breweries`, Breweries.state$Region)

names(Breweries.state.display) = c("State","Num of Breweries","Region")

Breweries.state.display %>% filter(Region == "West") %>% arrange(desc(`Num of Breweries`)) %>% kable() %>% kable_styling(bootstrap_options = "striped", "bordered", full_width = F)

Breweries.state.display %>% filter(Region == "Northeast") %>% arrange(desc(`Num of Breweries`)) %>% kable() %>% kable_styling(bootstrap_options = "striped", "bordered", full_width = F)

Breweries.state.display %>% filter(Region == "South") %>% arrange(desc(`Num of Breweries`)) %>% kable() %>% kable_styling(bootstrap_options = "striped", "bordered", full_width = F)

Breweries.state.display %>% filter(Region == "Midwest") %>% arrange(desc(`Num of Breweries`)) %>% kable() %>% kable_styling(bootstrap_options = "striped", "bordered", full_width = F)

```


##### 2. Merge beer data with the breweries data. Print the first 6 observations and the last six observations to check the merged file.

```{r}

colnames(Breweries)[1] <- "Brewery_id" #change column name to use as merge variable

Beer.Breweries <- merge(Beers, Breweries, by = "Brewery_id") #merge by brewery_id

names(Beer.Breweries)[2] <- "Beer Name" #clean up column name for beer
names(Beer.Breweries)[8] <- "Brewery Name" #clean up column name for brewery


head(Beer.Breweries,6) %>% kable() %>%
  kable_styling(c("striped", "bordered"))

tail(Beer.Breweries,6) %>% kable() %>%
  kable_styling(c("striped", "bordered"))

```


##### 3. Report the number of NA's in each column.

```{r}

na_count <-sapply(Beer.Breweries, function(y) sum(length(which(is.na(y))))) #use sapply to count NAs of each column
na_count <- as.data.frame(na_count) #change object to data frame

#show NAs in each column
na_count %>% kable() %>%
  kable_styling(bootstrap_options = "striped", "bordered", full_width = F) 

```


##### 4. Compute the median alcohol content and international bitterness unit for each state. Plot a bar chart to compare.

```{r, fig.width=16, fig.height=07}

Beer.Breweries.med <- aggregate(Beer.Breweries[,4:5], list(Beer.Breweries$State), median, na.rm = TRUE) #store medians of ABV & IBU / state in new data frame

names(Beer.Breweries.med)[1] = "State"

ggplot(Beer.Breweries.med, aes(x = State , y = ABV, fill = State)) + geom_bar(stat = "identity") + theme_light() +
  ggtitle("State Wise Beer Max ABV") +
  theme(plot.title = element_text(hjust = 0.5,size = 25,colour = "Red"))

ggplot(Beer.Breweries.med, aes(x = State , y = IBU, fill = State)) + geom_bar(stat = "identity") + theme_light() +
  ggtitle("State Wise Beer Max IBU") +
  theme(plot.title = element_text(hjust = 0.5,size = 25,colour = "Red"))

```

##### 5.Which state has the maximum alcoholic (ABV) beer? Which state has the most bitter (IBU) beer?
```{r}


Beer.Breweries[which.max(Beer.Breweries$ABV), c(4,10)] %>% kable() %>%
  kable_styling(bootstrap_options = "striped", "bordered", full_width = F) 

Beer.Breweries[which.max(Beer.Breweries$IBU), c(5,10)] %>% kable() %>%
  kable_styling(bootstrap_options = "striped", "bordered", full_width = F) 


```

##### 6. Summary statistics for the ABV variable.
```{r}

summary(Beer.Breweries$ABV)


```



##### 7. 

##### Is there an apparent relationship between the bitterness of the beer and its alcoholic content? Draw a scatter plot

```{r,fig.width=10, fig.height=07}

ggplot(Beer.Breweries, aes(x=Beer.Breweries$ABV, y=Beer.Breweries$IBU)) +
    geom_point(shape=1) +   
    geom_smooth(method=lm) +   ggtitle("Scatterplot for Alcoholic Content vs Bitterness") +
  theme(plot.title = element_text(hjust = 0.5,size = 15,colour = "Red"))  + labs(x = "ABV - Alcohol Content")  + labs(y = "IBU - Bitterness")

```





