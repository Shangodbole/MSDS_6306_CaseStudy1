---
title: "Case Study 1"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(magrittr)
library(ggplot2)
library(knitr)
library(kableExtra)


```

##### Get the Data

```{r}

file = "/Users/shantanu/Data_Files/Breweries.csv"
Breweries = read.csv(file=file,head=TRUE,sep=",")

# head(Breweries) %>%
#   kable() %>% 
#   kable_styling(c("striped", "bordered", full_width = FALSE))
# 
# head(Breweries)


file = "/Users/shantanu/Data_Files/Beers.csv"
Beers = read.csv(file=file,head=TRUE,sep=",")
# head(Beers)

```


##### 1. How many breweries are present in each state?

```{r}

Breweries.state <- as.data.frame(table(Breweries$State))

names(Breweries.state) = c("State", "Num of Breweries")

Breweries.state %>% kable() %>%
  kable_styling(bootstrap_options = "striped", "bordered", full_width = F) 

```


##### 2. Merge beer data with the breweries data. Print the first 6 observations and the last six observations to check the merged file.

```{r}

colnames(Breweries)[1] <- "Brewery_id" #change column name to use as merge variable

new.df <- merge(Beers, Breweries, by = "Brewery_id") #merge by brewery_id

names(new.df)[2] <- "Beer Name" #clean up column name for beer
names(new.df)[8] <- "Brewery Name" #clean up column name for brewery


head(new.df,6) %>% kable() %>%
  kable_styling(c("striped", "bordered"))

tail(new.df,6) %>% kable() %>%
  kable_styling(c("striped", "bordered"))

```


##### 3. Report the number of NA's in each column.

```{r}

na_count <-sapply(new.df, function(y) sum(length(which(is.na(y))))) #use sapply to count NAs of each column
na_count <- as.data.frame(na_count) #change object to data frame

#show NAs in each column
na_count %>% kable() %>%
  kable_styling(bootstrap_options = "striped", "bordered", full_width = F) 

```


##### 4. Compute the median alcohol content and international bitterness unit for each state. Plot a bar chart to compare.
```{r, fig.width=16, fig.height=07}

new.df.med <- aggregate(new.df[,4:5], list(new.df$State), median, na.rm = TRUE) #store medians of ABV & IBU / state in new data frame

names(new.df.med)[1] = "State"

head(new.df.med)

ggplot(new.df.med, aes(x = State , y = ABV, fill = State)) + geom_bar(stat = "identity") + theme_light() +
  ggtitle("State Wise Beer Max ABV") +
  theme(plot.title = element_text(hjust = 0.5,size = 25,colour = "Red"))

ggplot(new.df.med, aes(x = State , y = IBU, fill = State)) + geom_bar(stat = "identity") + theme_light() +
  ggtitle("State Wise Beer Max IBU") +
  theme(plot.title = element_text(hjust = 0.5,size = 25,colour = "Red"))

```

##### 5.Which state has the maximum alcoholic (ABV) beer? Which state has the most bitter (IBU) beer?
```{r}


new.df[which.max(new.df$ABV), c(4,10)] %>% kable() %>%
  kable_styling(bootstrap_options = "striped", "bordered", full_width = F) 

new.df[which.max(new.df$IBU), c(5,10)] 


```

##### 6. Summary statistics for the ABV variable.
```{r}

summary(new.df$ABV)

```



##### 7. 

##### Is there an apparent relationship between the bitterness of the beer and its alcoholic content? Draw a scatter plot
##### scatter.smooth(x = new.df$ABV, y = new.df$IBU) #basic plot showing correlation line
##### cor(new.df$ABV, new.df$IBU, use = "complete.obs") correlation cooefficients 
##### linearMod <- lm(IBU ~ ABV, data = new.df) #store linear model
##### summary(linearMod) #display summary of linear model

```{r,fig.width=10, fig.height=07}

ggplot(new.df, aes(x=new.df$ABV, y=new.df$IBU)) +
    geom_point(shape=1) +   
    geom_smooth(method=lm) +   ggtitle("Scatterplot for Alcoholic Content vs Bitterness") +
  theme(plot.title = element_text(hjust = 0.5,size = 15,colour = "Red"))  + labs(x = "ABV - Alcohol Content")  + labs(y = "IBU - Bitterness")

```





